name: graphrag-orchestration
metadata:
  template: graphrag-orchestration@1.0

services:
  graphrag:
    project: .
    language: python
    host: containerapp
    hooks:
      postdeploy:
        shell: sh
        run: |
          echo "Cleaning up GraphRAG Docker images to free space..."
          # Remove images matching the project name
          docker images --format '{{.Repository}}:{{.Tag}}' | grep 'graphrag-orchestration' | xargs -r docker rmi || true
          # Prune any dangling images
          docker image prune -f || true
