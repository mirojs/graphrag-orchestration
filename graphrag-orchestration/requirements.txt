# Core dependencies
fastapi>=0.115.0
python-multipart>=0.0.9
uvicorn[standard]>=0.30.0
pydantic>=2.10.3
pydantic-settings>=2.1.0
python-jose[cryptography]>=3.4.0  # JWT token validation for Azure Easy Auth â€” CVE-2024-33663/33664 patched in 3.4.0

# Minimal local stub for graspologic to avoid pulling heavy community deps in base builds.
# The real graspologic package is optional and can be installed with `requirements.community.txt`.
# NOTE: pip 25+ no longer accepts `name @ ./local/path` (missing URL scheme).
# Use a plain local project path reference instead.
./third_party/graspologic_stub

# GraphRAG (pinned to stable version)
graphrag==2.7.0

# LlamaIndex core + integrations
llama-index-core==0.14.12  # Uses ctx.store.set/get API for Workflows
llama-index-llms-azure-openai==0.4.2  # upgraded to match llama-index-core 0.14.x
llama-index-llms-openai==0.6.12  # upgrade candidate - requires testing
llama-index-embeddings-azure-openai==0.4.1  # upgrade to match llama-index-core 0.14.x
llama-index-vector-stores-azureaisearch==0.4.4
llama-index-vector-stores-lancedb==0.4.4
llama-index-embeddings-voyageai==0.5.3  # Voyage AI LlamaIndex wrapper (requires llama-index-core<0.15,>=0.13.0)
voyageai>=0.3.0  # Native Voyage client for contextual embeddings with tuples
# llama-index-graph-stores-neo4j removed - replaced by app/services/neo4j_standalone_store.py
# This enables neo4j driver v6.0+ compatibility for native Vector type support
scikit-learn>=1.4.0

# Community Detection (GraphRAG Global Search)
# Optional - moved to `requirements.community.txt` to avoid heavy deps in base image.
# Install community detection deps with: pip install -r requirements.community.txt
# graspologic==3.4.1  # moved to optional requirements
networkx==3.4.2

llama-parse>=0.6.0  # Layout-aware PDF parsing

# Vector stores (Azure AI Search)

# Graph stores
# neo4j driver v6.0+ required for native Vector type (Cypher 25)
# Upgraded from v5.x after removing llama-index-graph-stores-neo4j dependency
neo4j>=6.0.0
neo4j-graphrag==1.12.0  # v1.12.0 supports neo4j<7.0.0,>=5.17.0 (allows v6.0+)
rapidfuzz>=3.6.0  # Required by neo4j-graphrag
graphdatascience>=1.19  # Aura Serverless Graph Analytics (KNN, Louvain, PageRank)

# HippoRAG 2 - Deterministic multi-hop retrieval with Personalized PageRank
# hipporag>=0.1.0  # Optional - not used in current LlamaIndex-native implementation

# Azure SDKs
azure-cosmos==4.9.0
azure-storage-blob==12.24.0
azure-identity==1.20.0
azure-ai-documentintelligence==1.0.2
openai>=1.14.0,<2.0.0  # Compatible with llama-index-llms-openai 0.4.x

# Redis for async job queue (Worker container)
redis>=5.0.0  # Async Redis client (includes redis.asyncio)

# Utilities
python-dotenv>=1.0.0
structlog>=24.1.0
tenacity>=8.2.3
json-repair>=0.9.0  # Neo4j pattern: LLM JSON output repair for production reliability

# Async helpers
anyio>=4.0.0

# HTTP client for CU Standard ingestion
httpx>=0.25.0
